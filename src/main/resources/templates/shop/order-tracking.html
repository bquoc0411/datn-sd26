<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Tra c·ª©u ƒë∆°n h√†ng</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0/dist/css/tabler.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@2.30.0/tabler-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/Footer.css">
    <link rel="stylesheet" href="/css/Navbar.css">
    <style>
        .timeline-wrapper {
            position: relative;
            padding: 2rem 0;
        }

        .timeline {
            display: flex;
            position: relative;
            z-index: 1;
            gap: 1rem;
        }

        .timeline-step {
            position: relative;
            text-align: center;
            flex: 1;
        }

        .timeline-step.completed::after {
            background-color: #28a745;
        }

        .timeline-step::after {
            content: '';
            position: absolute;
            top: 24px;
            left: 50%;
            right: -50%;
            height: 4px;
            background-color: #dee2e6;
            z-index: -1;
        }

        .timeline-step:last-child::after {
            display: none;
        }

        .timeline-icon {
            width: 48px;
            height: 48px;
            background-color: #e9ecef;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .timeline-icon i {
            font-size: 24px;
            color: #6c757d;
        }

        .timeline-step.completed .timeline-icon {
            background-color: #28a745;
            color: #fff;
        }

        .timeline-step.active .timeline-icon {
            background-color: #ffc107;
            color: #000;
        }

        .timeline-label {
            font-size: 14px;
            font-weight: 600;
        }

        .timeline small {
            font-size: 12px;
            display: block;
            margin-top: 4px;
        }

        @media (max-width: 768px) {
            .timeline {
                flex-direction: column;
            }

            .timeline-step {
                flex: none;
                margin-bottom: 1.5rem;
            }

            .timeline-step::after {
                display: none;
            }
        }

    </style>


</head>
<body>
<div th:replace="~{components/navbar :: navbar}"></div>

<div class="card mt-5">
    <div class="card shadow-sm rounded-3 p-4">
        <h2 class="text-center mb-4">üîç Tra c·ª©u ƒë∆°n h√†ng</h2>
        <div class="row justify-content-center">
            <div class="col-md-6">
                <form th:action="@{/order-tracking}" method="post" class="search-form">
                    <div class="mb-3">
                        <label for="maHoaDon" class="form-label">M√£ h√≥a ƒë∆°n</label>
                        <input type="text" class="form-control" id="maHoaDon" name="maHoaDon"
                               placeholder="Nh·∫≠p m√£ h√≥a ƒë∆°n"/>
                    </div>
                    <div class="mb-3">
                        <label for="sdtNguoiNhan" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" class="form-control" id="sdtNguoiNhan" name="sdtNguoiNhan"
                               placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi nh·∫≠n"/>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">T√¨m ki·∫øm</button>
                </form>
            </div>
        </div>
    </div>

    <div class="text-center mt-3">
        <p th:if="${errorMessage}" th:text="${errorMessage}" class="text-danger fw-bold"></p>
    </div>

    <div th:if="${hoaDon != null}">
        <div class="card mt-4 shadow-sm mb-5">
            <div class="car-header"><h2 class="mb-3 mt-5 text-center"> Th√¥ng tin ƒë∆°n h√†ng </h2></div>
            <div class="card-body">
                <div class="row">
                    <!-- C·ªôt tr√°i: Th√¥ng tin ƒë∆°n h√†ng -->
                    <div class="col-md-6 mt-5">
                        <div class="mx-auto" style="max-width: 400px;">
                            <p><strong>M√£ h√≥a ƒë∆°n:</strong> <span th:text="${hoaDon.maHoaDon}">HD1</span></p>
                            <p><strong>Ng∆∞·ªùi nh·∫≠n:</strong> <span th:text="${hoaDon.tenNguoiNhan}">Nguy·ªÖn VƒÉn A</span>
                            </p>
                            <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span th:text="${hoaDon.sdtNguoiNhan}">0987xxx</span></p>
                            <p><strong>ƒê·ªãa ch·ªâ nh·∫≠n h√†ng:</strong> <span
                                    th:text="${hoaDon.diaChiNguoiNhan}">123 ABC</span>
                            </p>
                            <p><strong>Ph∆∞∆°ng th·ª©c thanh to√°n:</strong> <span th:text="${hoaDon.phuongThucThanhToan}">Ti·ªÅn m·∫∑t</span>
                            </p>
                            <p><strong>T·ªïng ti·ªÅn:</strong>
                                <span th:text="${#numbers.formatDecimal(hoaDon.tongTien, 0, 'COMMA', 0, 'POINT')}">100.000</span>
                                VNƒê
                            </p>
                            <p><strong>Tr·∫°ng th√°i:</strong> <span th:text="${hoaDon.trangThai}">ƒêang giao</span></p>
                        </div>
                    </div>

                    <!-- C·ªôt ph·∫£i: Danh s√°ch s·∫£n ph·∫©m -->
                    <div class="col-md-6 d-flex justify-content-center  mt-5">
                        <div class="row g-3 w-100" style="max-width: 400px;" th:each="item : ${chiTietList}">
                            <div class="col-12">
                                <div class="text-center">
                                    <!-- ·∫¢nh s·∫£n ph·∫©m -->
                                    <img th:if="${#lists.isEmpty(item.sanPhamChiTiet.hinhAnh) == false}"
                                         th:src="@{'/uploads/' + ${item.sanPhamChiTiet.hinhAnh[0].tenAnh}}"
                                         alt="·∫¢nh s·∫£n ph·∫©m"
                                         class="mb-3 rounded mx-auto d-block"
                                         style="max-height: 200px; width: 100%; object-fit: cover;"/>

                                    <!-- T√™n s·∫£n ph·∫©m -->
                                    <h6 class="fw-bold" th:text="${item.sanPhamChiTiet.sanPham.tenSanPham}">T√™n s·∫£n
                                        ph·∫©m</h6>

                                    <!-- Th∆∞∆°ng hi·ªáu | M√†u s·∫Øc | K√≠ch th∆∞·ªõc -->
                                    <p class="mb-2 text-muted small">
                                        <span th:text="${item.sanPhamChiTiet.thuongHieu.ten}">Nike</span> |
                                        <span th:text="${item.sanPhamChiTiet.mauSac.ten}">ƒêen</span> |
                                        <span th:text="${item.sanPhamChiTiet.kichCo.ten}">42</span>
                                    </p>

                                    <!-- Gi√° v√† s·ªë l∆∞·ª£ng -->
                                    <p class="text-danger fw-semibold"
                                       th:text="${#numbers.formatDecimal(item.sanPhamChiTiet.giaBan, 0, 'COMMA', 0, 'POINT')} + ' VNƒê'">
                                        500.000 VNƒê
                                    </p>
                                    <p><strong>S·ªë l∆∞·ª£ng:</strong> <span th:text="${item.soLuong}">1</span></p>
                                </div>
                            </div>
                        </div>
                    </div> <!-- end col s·∫£n ph·∫©m -->

                </div>
            </div>

            <div class="timeline-wrapper position-relative px-3 py-4">
                <div class="timeline-line"></div>
                <ul class="timeline list-unstyled d-flex justify-content-between align-items-start m-0 position-relative"
                    th:with="currentIndex=${allTrangThai.indexOf(currentStatus)}">

                    <li class="timeline-step text-center position-relative flex-fill"
                        th:each="statusName, iterStat : ${allTrangThai}"
                        th:classappend="|${iterStat.index == currentIndex ? 'active' : (iterStat.index < currentIndex ? 'completed' : '')}|">

                        <!-- ƒê∆∞·ªùng line n·ªëi gi·ªØa c√°c b∆∞·ªõc (·∫©n b∆∞·ªõc cu·ªëi) -->
                        <div class="timeline-line" th:if="${iterStat.index > 0 and !iterStat.last}"></div>

                        <!-- Icon tr·∫°ng th√°i -->
                        <div class="timeline-icon rounded-circle mx-auto mb-1 d-flex justify-content-center align-items-center">
                            <i class="ti" style="color: white"
                               th:classappend="
                     ${statusName.toLowerCase() == 'ch·ªù x√°c nh·∫≠n'} ? ' ti-clock' :
                     (${statusName.toLowerCase() == 'ƒë√£ x√°c nh·∫≠n'} ? ' ti-circle-check' :
                     (${statusName.toLowerCase() == 'ƒëang chu·∫©n b·ªã'} ? ' ti-package' :
                     (${statusName.toLowerCase() == 'ƒëang giao'} ? ' ti-truck' :
                     (${statusName.toLowerCase() == 'ho√†n th√†nh'} ? ' ti-checkup-list' :
                     (${statusName.toLowerCase() == 'ƒë√£ h·ªßy'} ? ' ti-x' : ' ti-alert-triangle')))))
                   "></i>
                        </div>

                        <!-- T√™n tr·∫°ng th√°i -->
                        <p class="timeline-label fw-semibold mb-1" th:text="${statusName}">Tr·∫°ng th√°i</p>

                        <!-- Th·ªùi gian ho·∫∑c ch·ªØ "Ch∆∞a c·∫≠p nh·∫≠t" -->
                        <small class="text-muted"
                               th:text="${thoiGianFormattedMap[statusName.toLowerCase()]} ?: 'Ch∆∞a c·∫≠p nh·∫≠t'">
                            Th·ªùi gian
                        </small>
                    </li>
                </ul>
            </div>

        </div>
    </div>
</div>
<div th:replace="~{components/footer :: footer}"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

</body>
</html>
